function cov_zbgprc3a4(){var path="C:\\Users\\User\\Documents\\DVOPS_Projects\\project1-yujie\\public\\js\\updateFeedback.js";var hash="9bb83f29e9d1742d091a1197e0469a97ecb60da4";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\User\\Documents\\DVOPS_Projects\\project1-yujie\\public\\js\\updateFeedback.js",statementMap:{"0":{start:{line:74,column:18},end:{line:74,column:56}},"1":{start:{line:77,column:25},end:{line:77,column:53}},"2":{start:{line:78,column:4},end:{line:81,column:5}},"3":{start:{line:79,column:8},end:{line:79,column:39}},"4":{start:{line:80,column:8},end:{line:80,column:15}},"5":{start:{line:83,column:18},end:{line:83,column:38}},"6":{start:{line:84,column:4},end:{line:84,column:52}},"7":{start:{line:85,column:4},end:{line:101,column:6}},"8":{start:{line:86,column:8},end:{line:100,column:9}},"9":{start:{line:87,column:29},end:{line:87,column:61}},"10":{start:{line:88,column:12},end:{line:95,column:13}},"11":{start:{line:89,column:40},end:{line:89,column:75}},"12":{start:{line:90,column:16},end:{line:90,column:62}},"13":{start:{line:91,column:16},end:{line:91,column:69}},"14":{start:{line:92,column:16},end:{line:92,column:65}},"15":{start:{line:94,column:16},end:{line:94,column:59}},"16":{start:{line:96,column:15},end:{line:100,column:9}},"17":{start:{line:97,column:12},end:{line:97,column:83}},"18":{start:{line:99,column:12},end:{line:99,column:48}},"19":{start:{line:102,column:4},end:{line:104,column:6}},"20":{start:{line:103,column:8},end:{line:103,column:71}},"21":{start:{line:105,column:4},end:{line:105,column:19}},"22":{start:{line:109,column:18},end:{line:109,column:56}},"23":{start:{line:110,column:28},end:{line:110,column:63}},"24":{start:{line:111,column:21},end:{line:111,column:42}},"25":{start:{line:114,column:4},end:{line:117,column:5}},"26":{start:{line:115,column:8},end:{line:115,column:39}},"27":{start:{line:116,column:8},end:{line:116,column:15}},"28":{start:{line:120,column:4},end:{line:123,column:5}},"29":{start:{line:121,column:8},end:{line:121,column:33}},"30":{start:{line:122,column:8},end:{line:122,column:15}},"31":{start:{line:125,column:18},end:{line:125,column:38}},"32":{start:{line:126,column:4},end:{line:126,column:59}},"33":{start:{line:127,column:4},end:{line:127,column:65}},"34":{start:{line:129,column:4},end:{line:138,column:6}},"35":{start:{line:130,column:8},end:{line:137,column:9}},"36":{start:{line:131,column:29},end:{line:131,column:61}},"37":{start:{line:132,column:12},end:{line:132,column:36}},"38":{start:{line:133,column:12},end:{line:133,column:52}},"39":{start:{line:135,column:29},end:{line:135,column:61}},"40":{start:{line:136,column:12},end:{line:136,column:36}},"41":{start:{line:140,column:4},end:{line:142,column:6}},"42":{start:{line:141,column:8},end:{line:141,column:71}},"43":{start:{line:144,column:4},end:{line:144,column:47}}},fnMap:{"0":{name:"retrieveFeedback",decl:{start:{line:73,column:9},end:{line:73,column:25}},loc:{start:{line:73,column:28},end:{line:106,column:1}},line:73},"1":{name:"(anonymous_1)",decl:{start:{line:85,column:21},end:{line:85,column:22}},loc:{start:{line:85,column:33},end:{line:101,column:5}},line:85},"2":{name:"(anonymous_2)",decl:{start:{line:102,column:22},end:{line:102,column:23}},loc:{start:{line:102,column:34},end:{line:104,column:5}},line:102},"3":{name:"updateFeedback",decl:{start:{line:108,column:9},end:{line:108,column:23}},loc:{start:{line:108,column:26},end:{line:145,column:1}},line:108},"4":{name:"(anonymous_4)",decl:{start:{line:129,column:21},end:{line:129,column:22}},loc:{start:{line:129,column:33},end:{line:138,column:5}},line:129},"5":{name:"(anonymous_5)",decl:{start:{line:140,column:22},end:{line:140,column:23}},loc:{start:{line:140,column:34},end:{line:142,column:5}},line:140}},branchMap:{"0":{loc:{start:{line:78,column:4},end:{line:81,column:5}},type:"if",locations:[{start:{line:78,column:4},end:{line:81,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:78},"1":{loc:{start:{line:86,column:8},end:{line:100,column:9}},type:"if",locations:[{start:{line:86,column:8},end:{line:100,column:9}},{start:{line:96,column:15},end:{line:100,column:9}}],line:86},"2":{loc:{start:{line:86,column:12},end:{line:86,column:57}},type:"binary-expr",locations:[{start:{line:86,column:12},end:{line:86,column:33}},{start:{line:86,column:37},end:{line:86,column:57}}],line:86},"3":{loc:{start:{line:88,column:12},end:{line:95,column:13}},type:"if",locations:[{start:{line:88,column:12},end:{line:95,column:13}},{start:{line:93,column:19},end:{line:95,column:13}}],line:88},"4":{loc:{start:{line:96,column:15},end:{line:100,column:9}},type:"if",locations:[{start:{line:96,column:15},end:{line:100,column:9}},{start:{line:98,column:15},end:{line:100,column:9}}],line:96},"5":{loc:{start:{line:114,column:4},end:{line:117,column:5}},type:"if",locations:[{start:{line:114,column:4},end:{line:117,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:114},"6":{loc:{start:{line:120,column:4},end:{line:123,column:5}},type:"if",locations:[{start:{line:120,column:4},end:{line:123,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:120},"7":{loc:{start:{line:130,column:8},end:{line:137,column:9}},type:"if",locations:[{start:{line:130,column:8},end:{line:137,column:9}},{start:{line:134,column:15},end:{line:137,column:9}}],line:130},"8":{loc:{start:{line:130,column:12},end:{line:130,column:57}},type:"binary-expr",locations:[{start:{line:130,column:12},end:{line:130,column:33}},{start:{line:130,column:37},end:{line:130,column:57}}],line:130}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9bb83f29e9d1742d091a1197e0469a97ecb60da4"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_zbgprc3a4=function(){return actualCoverage;};}return actualCoverage;}cov_zbgprc3a4();// function retrieveFeedback() {
//     const email = document.getElementById("email").value;
//     // Validate email format using regex
//     const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
//     if (!emailPattern.test(email)) {
//         alert('Invalid email address');
//         return;
//     }
//     var request = new XMLHttpRequest();
//     request.open("GET", `/feedback/${email}`, true);
//     request.onload = function () {
//         if (request.status >= 200 && request.status < 300) {
//             const response = JSON.parse(request.responseText);
//             if (response) {
//                 document.getElementById("feedback").value = response.feedbackText;
//                 document.getElementById("email").readOnly = true; // Make email read-only after retrieving feedback
//             } else {
//                 alert('No feedback found for this email.');
//             }
//         } else if (request.status === 404) {
//             alert('Email is unrecognized. Please enter a valid registered email.');
//         } else {
//             alert('Error retrieving feedback.');
//         }
//     };
//     request.onerror = function () {
//         alert('Request failed. Please check your network connection.');
//     };
//     request.send();
// }
// function updateFeedback() {
//     const email = document.getElementById("email").value;
//     const feedbackElement = document.getElementById("feedback");
//     const feedback = feedbackElement.value;
//     if (!feedback) {
//         alert('Feedback is required!');
//         return;
//     }
//     if (feedback === feedbackElement.defaultValue) {
//         alert('No changes made');
//         return;
//     }
//     var request = new XMLHttpRequest();
//     request.open("PUT", `/update-feedback/${email}`, true);
//     request.setRequestHeader('Content-Type', 'application/json');
//     request.onload = function () {
//         if (request.status >= 200 && request.status < 300) {
//             const response = JSON.parse(request.responseText);
//             alert(response.message);
//         } else {
//             const response = JSON.parse(request.responseText);
//             alert(response.message);
//         }
//     };
//     request.onerror = function () {
//         alert('Request failed. Please check your network connection.');
//     };
//     request.send(JSON.stringify({ feedback }));
// }
function retrieveFeedback(){cov_zbgprc3a4().f[0]++;const email=(cov_zbgprc3a4().s[0]++,document.getElementById("email").value);// Validate email format using regex
const emailPattern=(cov_zbgprc3a4().s[1]++,/^[^\s@]+@[^\s@]+\.[^\s@]+$/);cov_zbgprc3a4().s[2]++;if(!emailPattern.test(email)){cov_zbgprc3a4().b[0][0]++;cov_zbgprc3a4().s[3]++;alert('Invalid email address');cov_zbgprc3a4().s[4]++;return;}else{cov_zbgprc3a4().b[0][1]++;}var request=(cov_zbgprc3a4().s[5]++,new XMLHttpRequest());cov_zbgprc3a4().s[6]++;request.open("GET",`/feedback/${email}`,true);cov_zbgprc3a4().s[7]++;request.onload=function(){cov_zbgprc3a4().f[1]++;cov_zbgprc3a4().s[8]++;if((cov_zbgprc3a4().b[2][0]++,request.status>=200)&&(cov_zbgprc3a4().b[2][1]++,request.status<300)){cov_zbgprc3a4().b[1][0]++;const response=(cov_zbgprc3a4().s[9]++,JSON.parse(request.responseText));cov_zbgprc3a4().s[10]++;if(response){cov_zbgprc3a4().b[3][0]++;const feedbackElement=(cov_zbgprc3a4().s[11]++,document.getElementById("feedback"));cov_zbgprc3a4().s[12]++;feedbackElement.value=response.feedbackText;// Set current feedback text
cov_zbgprc3a4().s[13]++;feedbackElement.defaultValue=response.feedbackText;// Set default value for comparison
cov_zbgprc3a4().s[14]++;document.getElementById("email").readOnly=true;// Make email read-only after retrieving feedback
}else{cov_zbgprc3a4().b[3][1]++;cov_zbgprc3a4().s[15]++;alert('No feedback found for this email.');}}else{cov_zbgprc3a4().b[1][1]++;cov_zbgprc3a4().s[16]++;if(request.status===404){cov_zbgprc3a4().b[4][0]++;cov_zbgprc3a4().s[17]++;alert('Email is unrecognized. Please enter a valid registered email.');}else{cov_zbgprc3a4().b[4][1]++;cov_zbgprc3a4().s[18]++;alert('Error retrieving feedback.');}}};cov_zbgprc3a4().s[19]++;request.onerror=function(){cov_zbgprc3a4().f[2]++;cov_zbgprc3a4().s[20]++;alert('Request failed. Please check your network connection.');};cov_zbgprc3a4().s[21]++;request.send();}function updateFeedback(){cov_zbgprc3a4().f[3]++;const email=(cov_zbgprc3a4().s[22]++,document.getElementById("email").value);const feedbackElement=(cov_zbgprc3a4().s[23]++,document.getElementById("feedback"));const feedback=(cov_zbgprc3a4().s[24]++,feedbackElement.value);// Validate feedback input
cov_zbgprc3a4().s[25]++;if(!feedback){cov_zbgprc3a4().b[5][0]++;cov_zbgprc3a4().s[26]++;alert('Feedback is required!');cov_zbgprc3a4().s[27]++;return;}else{cov_zbgprc3a4().b[5][1]++;}// Check for unchanged feedback
cov_zbgprc3a4().s[28]++;if(feedback===feedbackElement.defaultValue){cov_zbgprc3a4().b[6][0]++;cov_zbgprc3a4().s[29]++;alert('No changes made');// Notify user
cov_zbgprc3a4().s[30]++;return;// Do not send the request
}else{cov_zbgprc3a4().b[6][1]++;}var request=(cov_zbgprc3a4().s[31]++,new XMLHttpRequest());cov_zbgprc3a4().s[32]++;request.open("PUT",`/update-feedback/${email}`,true);cov_zbgprc3a4().s[33]++;request.setRequestHeader('Content-Type','application/json');cov_zbgprc3a4().s[34]++;request.onload=function(){cov_zbgprc3a4().f[4]++;cov_zbgprc3a4().s[35]++;if((cov_zbgprc3a4().b[8][0]++,request.status>=200)&&(cov_zbgprc3a4().b[8][1]++,request.status<300)){cov_zbgprc3a4().b[7][0]++;const response=(cov_zbgprc3a4().s[36]++,JSON.parse(request.responseText));cov_zbgprc3a4().s[37]++;alert(response.message);// Notify user of success or any specific backend message
cov_zbgprc3a4().s[38]++;feedbackElement.defaultValue=feedback;// Update defaultValue to the new feedback after a successful update
}else{cov_zbgprc3a4().b[7][1]++;const response=(cov_zbgprc3a4().s[39]++,JSON.parse(request.responseText));cov_zbgprc3a4().s[40]++;alert(response.message);}};cov_zbgprc3a4().s[41]++;request.onerror=function(){cov_zbgprc3a4().f[5]++;cov_zbgprc3a4().s[42]++;alert('Request failed. Please check your network connection.');};cov_zbgprc3a4().s[43]++;request.send(JSON.stringify({feedback}));}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfemJncHJjM2E0IiwiYWN0dWFsQ292ZXJhZ2UiLCJyZXRyaWV2ZUZlZWRiYWNrIiwiZiIsImVtYWlsIiwicyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsImVtYWlsUGF0dGVybiIsInRlc3QiLCJiIiwiYWxlcnQiLCJyZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwib25sb2FkIiwic3RhdHVzIiwicmVzcG9uc2UiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJmZWVkYmFja0VsZW1lbnQiLCJmZWVkYmFja1RleHQiLCJkZWZhdWx0VmFsdWUiLCJyZWFkT25seSIsIm9uZXJyb3IiLCJzZW5kIiwidXBkYXRlRmVlZGJhY2siLCJmZWVkYmFjayIsInNldFJlcXVlc3RIZWFkZXIiLCJtZXNzYWdlIiwic3RyaW5naWZ5Il0sInNvdXJjZXMiOlsidXBkYXRlRmVlZGJhY2suanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZnVuY3Rpb24gcmV0cmlldmVGZWVkYmFjaygpIHtcclxuLy8gICAgIGNvbnN0IGVtYWlsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlbWFpbFwiKS52YWx1ZTtcclxuXHJcbi8vICAgICAvLyBWYWxpZGF0ZSBlbWFpbCBmb3JtYXQgdXNpbmcgcmVnZXhcclxuLy8gICAgIGNvbnN0IGVtYWlsUGF0dGVybiA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xyXG4vLyAgICAgaWYgKCFlbWFpbFBhdHRlcm4udGVzdChlbWFpbCkpIHtcclxuLy8gICAgICAgICBhbGVydCgnSW52YWxpZCBlbWFpbCBhZGRyZXNzJyk7XHJcbi8vICAgICAgICAgcmV0dXJuO1xyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbi8vICAgICByZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgYC9mZWVkYmFjay8ke2VtYWlsfWAsIHRydWUpO1xyXG4vLyAgICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID49IDIwMCAmJiByZXF1ZXN0LnN0YXR1cyA8IDMwMCkge1xyXG4vLyAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpO1xyXG4vLyAgICAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcclxuLy8gICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmVlZGJhY2tcIikudmFsdWUgPSByZXNwb25zZS5mZWVkYmFja1RleHQ7XHJcbi8vICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVtYWlsXCIpLnJlYWRPbmx5ID0gdHJ1ZTsgLy8gTWFrZSBlbWFpbCByZWFkLW9ubHkgYWZ0ZXIgcmV0cmlldmluZyBmZWVkYmFja1xyXG4vLyAgICAgICAgICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgICAgICAgICAgYWxlcnQoJ05vIGZlZWRiYWNrIGZvdW5kIGZvciB0aGlzIGVtYWlsLicpO1xyXG4vLyAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDA0KSB7XHJcbi8vICAgICAgICAgICAgIGFsZXJ0KCdFbWFpbCBpcyB1bnJlY29nbml6ZWQuIFBsZWFzZSBlbnRlciBhIHZhbGlkIHJlZ2lzdGVyZWQgZW1haWwuJyk7XHJcbi8vICAgICAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICAgICAgYWxlcnQoJ0Vycm9yIHJldHJpZXZpbmcgZmVlZGJhY2suJyk7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfTtcclxuLy8gICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICBhbGVydCgnUmVxdWVzdCBmYWlsZWQuIFBsZWFzZSBjaGVjayB5b3VyIG5ldHdvcmsgY29ubmVjdGlvbi4nKTtcclxuLy8gICAgIH07XHJcbi8vICAgICByZXF1ZXN0LnNlbmQoKTtcclxuLy8gfVxyXG5cclxuXHJcbi8vIGZ1bmN0aW9uIHVwZGF0ZUZlZWRiYWNrKCkge1xyXG4vLyAgICAgY29uc3QgZW1haWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVtYWlsXCIpLnZhbHVlO1xyXG4vLyAgICAgY29uc3QgZmVlZGJhY2tFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmZWVkYmFja1wiKTtcclxuLy8gICAgIGNvbnN0IGZlZWRiYWNrID0gZmVlZGJhY2tFbGVtZW50LnZhbHVlO1xyXG5cclxuLy8gICAgIGlmICghZmVlZGJhY2spIHtcclxuLy8gICAgICAgICBhbGVydCgnRmVlZGJhY2sgaXMgcmVxdWlyZWQhJyk7XHJcbi8vICAgICAgICAgcmV0dXJuO1xyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIGlmIChmZWVkYmFjayA9PT0gZmVlZGJhY2tFbGVtZW50LmRlZmF1bHRWYWx1ZSkge1xyXG4vLyAgICAgICAgIGFsZXJ0KCdObyBjaGFuZ2VzIG1hZGUnKTtcclxuLy8gICAgICAgICByZXR1cm47XHJcbi8vICAgICB9XHJcblxyXG4vLyAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuLy8gICAgIHJlcXVlc3Qub3BlbihcIlBVVFwiLCBgL3VwZGF0ZS1mZWVkYmFjay8ke2VtYWlsfWAsIHRydWUpO1xyXG4vLyAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xyXG5cclxuLy8gICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PSAyMDAgJiYgcmVxdWVzdC5zdGF0dXMgPCAzMDApIHtcclxuLy8gICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcclxuLy8gICAgICAgICAgICAgYWxlcnQocmVzcG9uc2UubWVzc2FnZSk7XHJcbi8vICAgICAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcclxuLy8gICAgICAgICAgICAgYWxlcnQocmVzcG9uc2UubWVzc2FnZSk7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfTtcclxuXHJcbi8vICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgYWxlcnQoJ1JlcXVlc3QgZmFpbGVkLiBQbGVhc2UgY2hlY2sgeW91ciBuZXR3b3JrIGNvbm5lY3Rpb24uJyk7XHJcbi8vICAgICB9O1xyXG5cclxuLy8gICAgIHJlcXVlc3Quc2VuZChKU09OLnN0cmluZ2lmeSh7IGZlZWRiYWNrIH0pKTtcclxuLy8gfVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiByZXRyaWV2ZUZlZWRiYWNrKCkge1xyXG4gICAgY29uc3QgZW1haWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVtYWlsXCIpLnZhbHVlO1xyXG5cclxuICAgIC8vIFZhbGlkYXRlIGVtYWlsIGZvcm1hdCB1c2luZyByZWdleFxyXG4gICAgY29uc3QgZW1haWxQYXR0ZXJuID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XHJcbiAgICBpZiAoIWVtYWlsUGF0dGVybi50ZXN0KGVtYWlsKSkge1xyXG4gICAgICAgIGFsZXJ0KCdJbnZhbGlkIGVtYWlsIGFkZHJlc3MnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgIHJlcXVlc3Qub3BlbihcIkdFVFwiLCBgL2ZlZWRiYWNrLyR7ZW1haWx9YCwgdHJ1ZSk7XHJcbiAgICByZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPj0gMjAwICYmIHJlcXVlc3Quc3RhdHVzIDwgMzAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmVlZGJhY2tFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmZWVkYmFja1wiKTtcclxuICAgICAgICAgICAgICAgIGZlZWRiYWNrRWxlbWVudC52YWx1ZSA9IHJlc3BvbnNlLmZlZWRiYWNrVGV4dDsgLy8gU2V0IGN1cnJlbnQgZmVlZGJhY2sgdGV4dFxyXG4gICAgICAgICAgICAgICAgZmVlZGJhY2tFbGVtZW50LmRlZmF1bHRWYWx1ZSA9IHJlc3BvbnNlLmZlZWRiYWNrVGV4dDsgLy8gU2V0IGRlZmF1bHQgdmFsdWUgZm9yIGNvbXBhcmlzb25cclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZW1haWxcIikucmVhZE9ubHkgPSB0cnVlOyAvLyBNYWtlIGVtYWlsIHJlYWQtb25seSBhZnRlciByZXRyaWV2aW5nIGZlZWRiYWNrXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgnTm8gZmVlZGJhY2sgZm91bmQgZm9yIHRoaXMgZW1haWwuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgICAgYWxlcnQoJ0VtYWlsIGlzIHVucmVjb2duaXplZC4gUGxlYXNlIGVudGVyIGEgdmFsaWQgcmVnaXN0ZXJlZCBlbWFpbC4nKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhbGVydCgnRXJyb3IgcmV0cmlldmluZyBmZWVkYmFjay4nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFsZXJ0KCdSZXF1ZXN0IGZhaWxlZC4gUGxlYXNlIGNoZWNrIHlvdXIgbmV0d29yayBjb25uZWN0aW9uLicpO1xyXG4gICAgfTtcclxuICAgIHJlcXVlc3Quc2VuZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVGZWVkYmFjaygpIHtcclxuICAgIGNvbnN0IGVtYWlsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlbWFpbFwiKS52YWx1ZTtcclxuICAgIGNvbnN0IGZlZWRiYWNrRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmVlZGJhY2tcIik7XHJcbiAgICBjb25zdCBmZWVkYmFjayA9IGZlZWRiYWNrRWxlbWVudC52YWx1ZTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBmZWVkYmFjayBpbnB1dFxyXG4gICAgaWYgKCFmZWVkYmFjaykge1xyXG4gICAgICAgIGFsZXJ0KCdGZWVkYmFjayBpcyByZXF1aXJlZCEnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIHVuY2hhbmdlZCBmZWVkYmFja1xyXG4gICAgaWYgKGZlZWRiYWNrID09PSBmZWVkYmFja0VsZW1lbnQuZGVmYXVsdFZhbHVlKSB7XHJcbiAgICAgICAgYWxlcnQoJ05vIGNoYW5nZXMgbWFkZScpOyAvLyBOb3RpZnkgdXNlclxyXG4gICAgICAgIHJldHVybjsgLy8gRG8gbm90IHNlbmQgdGhlIHJlcXVlc3RcclxuICAgIH1cclxuXHJcbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgcmVxdWVzdC5vcGVuKFwiUFVUXCIsIGAvdXBkYXRlLWZlZWRiYWNrLyR7ZW1haWx9YCwgdHJ1ZSk7XHJcbiAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XHJcblxyXG4gICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID49IDIwMCAmJiByZXF1ZXN0LnN0YXR1cyA8IDMwMCkge1xyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICBhbGVydChyZXNwb25zZS5tZXNzYWdlKTsgLy8gTm90aWZ5IHVzZXIgb2Ygc3VjY2VzcyBvciBhbnkgc3BlY2lmaWMgYmFja2VuZCBtZXNzYWdlXHJcbiAgICAgICAgICAgIGZlZWRiYWNrRWxlbWVudC5kZWZhdWx0VmFsdWUgPSBmZWVkYmFjazsgLy8gVXBkYXRlIGRlZmF1bHRWYWx1ZSB0byB0aGUgbmV3IGZlZWRiYWNrIGFmdGVyIGEgc3VjY2Vzc2Z1bCB1cGRhdGVcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICBhbGVydChyZXNwb25zZS5tZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhbGVydCgnUmVxdWVzdCBmYWlsZWQuIFBsZWFzZSBjaGVjayB5b3VyIG5ldHdvcmsgY29ubmVjdGlvbi4nKTtcclxuICAgIH07XHJcblxyXG4gICAgcmVxdWVzdC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgZmVlZGJhY2sgfSkpO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6Im12TUFlWTtBQUFBQSxhQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGFBQUEsR0FmWjtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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